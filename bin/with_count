#!/usr/bin/env bash
if [ $1 == "--help" ]; then
    echo "Pipe a command into with_count to count the lines as they appear. Counting starts at 1. An argument can be provided to pick a different starting number. A second argument can be provided to not print the number for all numbers below it"
    exit 2;
fi
if [ $# -gt 2 ]; then
    >&2 echo "with_count expects 0, 1, or 2 arguments"
    exit 1;
fi
if [ -n "$1" ]; then
    i="$1"
else
    i="1"
fi
if [ -n "$2" ]; then
    ignore_below="$2"
else
    ignore_below="$i"
fi
while read line; do
    if (( "$i" >= "$ignore_below" )); then
        echo -en "$i\t"
    fi
    echo "$line"
    i=$((i+1))
done
